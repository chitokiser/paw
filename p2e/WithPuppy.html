<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>PAW DAO ¬∑ WithPuppy</title>
  <link rel="shortcut icon" href="../images/logo.png"/>

  <!-- Bootstrap (single) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"/>

  <!-- Site CSS -->
  <link rel="stylesheet" href="/css/main.css"/>
  <link rel="stylesheet" href="/css/puppywith.css"/>

  <!-- Scoped micro styles (no global override) -->
  <style>
    .wp-scope .card{border-radius:16px}
    .wp-scope .card-header{border-top-left-radius:16px;border-top-right-radius:16px}
    .wp-scope .btn{min-height:44px;border-radius:12px;font-weight:600}
    .wp-scope .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
    .wp-scope .img-container{display:flex;justify-content:center}
    .wp-scope .puppy-img{max-width:200px;height:auto}
    .wp-scope .status-box{min-height:24px}
    /* simple stat bars */
    .wp-scope .stat-line{display:flex;align-items:center;gap:8px;margin:.25rem 0}
    .wp-scope .stat-label{width:36px;font-weight:700;font-size:.85rem}
    .wp-scope .stat-bar-horizontal{flex:1;height:8px;background:#edf2f7;border-radius:6px;overflow:hidden}
    .wp-scope .stat-fill-horizontal{height:100%}
    @media (max-width:576px){ .wp-scope .card-title{font-size:1.05rem} }
  </style>
</head>
<body class="wp-scope">

  <!-- Header inject -->
  <div id="menu-placeholder"></div>
  <script>
    (async () => {
      try {
        const html = await fetch('../dashboard.html').then(r => r.text());
        const host = document.getElementById('menu-placeholder');
        host.innerHTML = html;
        // Make navbar full-width like other pages
        host.querySelectorAll('.navbar .container').forEach(c => {
          c.classList.remove('container');
          c.classList.add('container-fluid','px-0');
        });
        // Load topinfo after header present, then kick metrics (if any)
        const s = document.createElement('script');
        s.src = '../src/topinfo.js';
        s.defer = true;
        s.onload = () => (typeof topData === 'function') && topData();
        document.body.appendChild(s);
      } catch(e) { console.error('Error loading dashboard:', e); }
    })();
  </script>

  <main class="container my-4">
    <!-- Intro -->
    <div class="card mb-4">
      <div class="card-header bg-light">
        <h5 class="mb-0">WithPuppy (game point only)</h5>
      </div>
      <div class="card-body">
        <p>You need <strong>1000 GP</strong> to create your puppy.</p>
        <p>You earn <strong>GP</strong> by using your puppy in games.</p>
        <p>Improving stats gives additional bonus GP.</p>
        <p>Feeding randomly improves stats <strong>(Consumes 500 GP)</strong>.</p>
      </div>
    </div>

    <!-- My Puppy -->
    <div class="card mb-4">
      <div class="card-header d-flex justify-content-between align-items-center">
        <p class="mb-0 fw-bold">[My Puppy] Create &amp; Feed (1 per account)</p>
        <button class="btn btn-outline-secondary btn-sm" type="button"
                data-bs-toggle="collapse" data-bs-target="#myPuppyContent"
                aria-expanded="true" aria-controls="myPuppyContent">Toggle</button>
      </div>
      <div id="myPuppyContent" class="collapse show">
        <div class="card-body">
          <label for="puppyName" class="form-label fw-bold">Enter Puppy Name</label>
          <input type="text" id="puppyName" class="form-control mb-3" placeholder="Enter your puppy name"/>

          <button id="mintBtn" class="btn btn-primary w-100 mb-2">Create My Puppy (-1000 GP)</button>

          <div class="text-center mt-4">
            <button onclick="loadMyPuppyInfo()" class="btn btn-outline-info">MyPuppy</button>
            <div class="img-container mt-3">
              <img id="puppyImg" class="puppy-img" style="display:none" src="" alt="My Puppy"/>
            </div>
            <!-- WithPuppy.js Í∞Ä Ïù¥ ÏóòÎ¶¨Î®ºÌä∏Ïóê Ïù¥Î¶ÑÏùÑ Ïì∏ Ïàò ÏûàÎèÑÎ°ù Ï†úÍ≥µ -->
            <h6 id="puppyNameLabel" class="mt-2"></h6>
            <div id="puppyInfo" class="mt-2"></div>
          </div>

          <h6 class="fw-bold mt-4">Play</h6>
          <div id="status" class="status-box"></div>

          <div class="d-flex gap-2 flex-wrap mb-3">
            <button type="button" onclick="feedMyPuppy()" class="btn btn-outline-success flex-fill">üçñ Feeding (-500 GP)</button>
          </div>

          <div class="d-flex gap-2 flex-wrap">
            <a href="PuppyWar.html"    class="btn btn-outline-primary flex-fill">‚öîÔ∏è PuppyWar</a>
            <a href="PuppyLotto.html"  class="btn btn-outline-warning flex-fill">üé≤ PuppyLotto</a>
            <a href="HiPuppy.html"     class="btn btn-outline-primary flex-fill">üß¨ HiPuppy</a>
            <a href="PuppyRace.html"   class="btn btn-outline-warning flex-fill">üèÅ Race</a>
            <a href="PuppyBattle.html" class="btn btn-outline-danger  flex-fill">‚ö° Battle</a>
            <a href="PuppyHunt.html"   class="btn btn-outline-dark    flex-fill">üéØ Hunt</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Puppy List -->
    <div class="text-center my-5">
      <h2>Puppy List (<span id="totalPid">0</span>)</h2>
    </div>
    <div class="grid" id="list"></div>
  </main>

  <!-- Footer inject -->
  <div id="footer"></div>
  <script>
    (async () => {
      try {
        const html = await fetch('../footer.html').then(r => r.text());
        document.getElementById('footer').innerHTML = html;
      } catch(e) { console.error('Error loading footer:', e); }
    })();
  </script>

  <!-- Vendor JS (defer) -->
  <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

  <!-- App JS -->
  <script defer src="../src/WithPuppy.js"></script>
</body>
</html>
